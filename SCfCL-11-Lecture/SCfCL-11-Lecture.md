---
marp: true
math: katex
paginate: true
---
<!-- スライドURL：https://docs.google.com/presentation/d/1uOo1fFzA0Z9ZambhJze-0ymoqm2VGo6yVRYnZl59YQ0/edit?usp=sharing --->

# コンピュータリテラシ発展 〜Pythonを学ぶ〜

## 第11回：表計算やデータ分析をやってみよう

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の授業内容

---

# 今回の授業内容

- 前回の課題解説
- データを分析する
- データを可視化する
- 課題

---

# 前回の課題解説

---

# 前回の課題解説

- 前回の課題の解答例を示します
- 解答例について質問があればご連絡ください

## 解答例

（第10回課題の解答例を作成したURLを貼る）

---

# データを分析する

---

# データの準備

- これから行う分析のためにデータを準備します
- Moodleにある「**data_analysis.zip**」をダウンロードして解凍してください
- Google Driveの作業場所に「**data_analysis**」フォルダごとアップロードします
- 「**data_analysis**」の中身は次のとおりです
  - 「customer.csv」
  - 「item.csv」
  - 「transaction_1.csv」
  - 「transaction_2.csv」

---

# データを読み込む

### 目標：商品の購買データと顧客データを組み合わせ，購買分析を行います
- pandasを使ってデータを読み込み，顧客ID上位5名の顧客情報を表示させます
- `read_csv()`関数：CSVファイルをpandasにデータを読み込ませます
- 読み込んだデータはDataFrameオブジェクトとして扱うことができます
- DataFrameオブジェクトの`head()`メソッドでデータの先頭5行を表示できます

```py
あとでプログラムを入れる
```

---

# データを読み込む

- データセットの読み込み関数
- pandasでは各種データセットを読み込む関数が用意されています

| データ形式 |      関数      |                       解説                       |
| ---------- | -------------- | ------------------------------------------------ |
| CSV        | `read_csv()`   | 区切り文字で区切られたデータを読み込む           |
| excel      | `read_excel()` | Excel形式のデータ（拡張子.xls，.xlsx）を読み込む |
| json       | `read_json()`  | [JSON]()データを読み込む                         |
| html       | `read_html()`  | HTMLファイル内のテーブル形式のデータを読み込む   |

（JSONのwikiの短縮URLを取得して貼り付ける）

---

# データを読み込む

- データの基本情報を確認します
- pandasには，データの基本情報を簡単に表示するオプションも提供されています
- DataFrameオブジェクトのオプションを以下の表にまとめます

| オプション |                          解説                          |
| ---------- | ------------------------------------------------------ |
| `shape`    | 行数と列数を表示する（例:15行6列の場合，(15,6)と出力） |
| `columns`  | 列名を表示する                                         |
| `dtypes`   | 列名と，列のデータ型を表示                             |


---

# データを結合する

- 以下の2つの結合方法について解説します
  - データを縦方向に結合する処理
  - 特定の列をキーにして横方向にデータを結合する処理

---

# pandasの基本的な使い方

- pandasはPythonでデータ操作や分析を行う上で重要なライブラリです
- pandasを使うことで以下のようなことができます
  - データ操作
  - データ結合と操作
  - データの欠損値処理
  - 時系列データのサポート
  - データの入出力

公式サイト：https://pandas.pydata.org/
Qiita：https://qiita.com/tags/pandas

---

# pandasの基本的な使い方

- pandasはすでにGoogle Colabに入っているのでインストールの必要はありません
- インポートをする必要はあります
- 一般的にpandasは「`pd`」と省略して扱われます

```py
# pandasモジュールをインポートして「pd」と省略する
import pandas as pd
```

---

# pandasの基本的な使い方

- `Series`オブジェクト
  - 一次元のコンテナです
  - コンテナ：オブジェクトの集まりを表現するデータ構造のこと
- `DataFrame`オブジェクト
  - Excelのような表形式のデータを扱います
  - 行や列として一次元のデータ構造（`Series`オブジェクト）の集まりを，表形式のデータ構造(`DataFrame`オブジェクト)で扱います

---

# pandasの基本的な使い方

- `DataFrame`と`Series`オブジェクト
- 名前データを扱う一次元データ（Series）を作成します

```py
#一度インポートしたら毎回書かなくてもよい
import pandas as pd

# 名前のリストを元にpandasのSeriesオブジェクトを作成
# Seriesは一列のデータを扱うためのデータ構造
name_series = pd.Series(['田中', '北野'])

# 作成したSeriesオブジェクトを表示
print(name_series)
```

---

# pandasの基本的な使い方

- `DataFrame`と`Series`オブジェクト
- 年齢データを追加して１次元データの集まり（DataFrame）を作成します
- 見出しとなる「**名前**」「**年齢**」を追加します

```py
# 名前と年齢のデータを含むデータフレームを作成
# '名前' 列には事前に定義された Series オブジェクト 'name_series' を使用
# '年齢' 列には年齢のリスト [22, 28] を指定
people = pd.DataFrame({
    '名前': name_series,
    '年齢': [22, 28]
})

print(people)
```

---

# pandasの基本的な使い方

- `DataFrame`と`Series`オブジェクト
- DataFrameは列単位でSeriesオブジェクトとして取り出すことができます

```py
import pandas as pd

# 先に作成されたデータフレーム 'people' の '年齢' 列を表示
print(people['年齢'])
```

---

# pandasの基本的な使い方

## インデックスラベル（行名）
- これまでの結果からわかるように１番左の列に，「`０`」や「`１`」の数字が表示されます
- これを「**インデックスラベル（行名）**」と呼びます
- デフォルトでは「`0`」からはじまるので注意してください

![](img/10-001.png)

---

# pandasの基本的な使い方

- **インデックスラベル（行名）**
  - `Series`オブジェクトや`DataFrame`オブジェクトの引数「`index`」を指定します
  - これによりデフォルトでない値を使用することができます
  - DataFrameオブジェクトでも同様に指定できます
  - インデックスラベルは数字だけでなく，文字列を指定することもできます

```py
# 名前のリストを元にpandasのSeriesオブジェクトを作成
# '田中' と '北野' という名前のリスト
# インデックスラベルを [10, 20] に設定
# （デフォルトのインデックスを使わずに指定したインデックスを使用）
name_series = pd.Series(['田中', '北野'], index = [10, 20])

print(name_series)
```

---

# pandasの基本的な使い方

## 行インデックス（行番号）
- インデックスラベルとは別に，「**行インデックス(行番号)**」も同様に指定することができます
- 行インデックスは，インデックスラベルのように別名をつけることができません
- １行目が「`0`」となるので注意してください

---

# pandasの基本的な使い方

- `loc`と`iloc`属性によるデータの選択
  - **loc属性**
    - ラベルを用いて行や列にアクセスするための属性
    - 行や列のラベルを指定して特定のデータにアクセスする際に使用
  - **iloc属性**
    - インデックスを用いて行や列にアクセスするための属性
    - 行や列の位置（インデックス）を指定して特定のデータにアクセスする際に使用

---

# pandasの基本的な使い方

- **loc**と**iloc**属性によるデータの選択
  - 前準備としてDataFrameオブジェクトを作成する

```py
# 年齢、身長、体重のデータを含むデータフレームを作成
# '年齢', '身長', '体重' という列を持つデータフレーム
# インデックスラベルは ['田中', '北野', '高橋', '岡田', '長谷川'] に設定
people = pd.DataFrame({
    '年齢': [21, 34, 23, 44, 19],
    '身長': [180, 168, 174, 181, 169],
    '体重': [74, 61, 65, 82, 70]
},
    index=['田中', '北野', '高橋', '岡田', '長谷川'])

print(people)
```

---

# pandasの基本的な使い方

- `loc`と`iloc`属性によるデータの選択
  - インデックスラベルが「`北野`」のデータを取り出す方法（loc属性利用）
  - 行インデックスが「`1`」のデータを取り出す方法(iloc属性利用）
  - 同じ結果になります


```py
# '北野'という名前のインデックスラベルに対応する
# 行をデータフレーム 'people' から取得し、表示
print(people.loc['北野'])

# インデックス位置が1（2番目の行）に対応する
# 行をデータフレーム 'people' から取得し、表示
print(people.iloc[1])
```

---

# pandasの基本的な使い方

- `loc`と`iloc`属性によるデータの選択
  - 必要な列に絞って取得することも可能
  - 結果は同じになります

```py
# '高橋'という名前のインデックスラベルに対応する行から、
# 特定の列（'年齢'と'体重'）を取得し、表示
print(people.loc['高橋', ['年齢', '体重']])

# インデックス位置が2（3番目の行）に対応する行から、
# 特定の列（0番目と2番目の列：'年齢'と'体重'）を取得し、表示
print(people.iloc[2, [0, 2]])
```

---

# pandasの基本的な使い方

- `loc`と`iloc`属性によるデータの選択
  - `[start:stop]`形式で取り出したい部分を指定できます
  - これをスライス記法と呼ぶ
  - 結果は同じになります

```py
# インデックスラベルが '高橋' から '長谷川' までの行を
# データフレーム 'people' から取得し、表示
# locプロパティを使用して、インデックスラベルで範囲を指定
print(people.loc['高橋':'長谷川'])

# インデックス位置が2から4（3番目から5番目の行）までの行を
# データフレーム 'people' から取得し、表示
# ilocプロパティを使用して、整数値で範囲を指定
print(people.iloc[2:5])
```

---

# 課題

---

# 課題

- Moodleにある「SCfCL-10th-prac.ipynb」ファイルをダウンロードしてColabにアップロードしてください
- 課題が完了したら「File」>「Download」>「Download .ipynb」で「.ipynb」形式でダウンロードしてください
- ダウンロードした **.ipynbファイル** をMoodleに提出してください
- 提出期限は **6月27日(木) 20時まで** です
