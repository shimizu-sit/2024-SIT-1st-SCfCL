---
marp: true
math: katex
paginate: true
---

# コンピュータリテラシ発展 〜Pythonを学ぶ〜

## 第5回：Excel作業を自動化しよう

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の授業内容

---

# 今回の授業内容

- 前回の課題解説
- 準備：Google Driveをマウントする
- 準備：PythonでExcelを操作する
- Excelの値を表示する
- 課題

---

# 前回の課題解説

---

# 前回の課題解説

- 前回の課題の解答例を示します
- 解答例について質問があればご連絡ください

## 解答例

（解答例を作成後URL貼り付け）

---

# 準備：Google Driveをマウントする

---

# Colab上でExcelファイルを扱うためには？

ColabでExcelファイルを扱う方法は複数あります
1. プログラムでExcelファイルを読み込む方法
2. ローカルにあるExcelファイルを読み込む方法
3. Google Driveをマウントして読み込む方法
4. Colabに直接アップロードして読み込む方法

---

# Colab上でExcelファイルを扱うためには？

一番簡単な方法

- **4.「Colabに直接アップロードして読み込む方法」**
- **注意** ：ランタイムが終了するとファイルが削除されます

この授業では

- **3.「Google Driveをマウントして読み込む方法」**
- 作業しているファイルが削除されずに済むのでこの方法を採用します
- 基本的に今後この形式でファイル読み込みを行うので覚えておいてください

---

# Google Driveをマウントする手順

![w:900](img/05-001.png)


---

# Google Driveをマウントする手順

![w:900](img/05-002.png)

---

# Google Driveをマウントする手順

![w:900](img/05-003.png)

---

# Google Driveをマウントする手順

![w:900](img/05-004.png)

---

# Drive上に作業用フォルダを作成

- MyDriveの直下にフォルダを作成します
- 作成方法
  - Colabから作成する方法
  - Driveから作成する方法
- フォルダ名は**アルファベットのみ**にしてください
- 例：「Hatten」「CLHatten」など

---

# Colabからフォルダを作成する方法

![w:900](img/05-005.png)

---

# Colabからフォルダを作成する方法

![w:900](img/05-006.png)

---

# Colabからフォルダを作成する方法

![w:900](img/05-007.png)

---

# 準備：PythonでExcelを操作する

---

# OpenPyXLについて

- PythonでExcelの読み書きをするためのライブラリです
- Pythonを使って次のような操作ができます
  - セルの値をPythonで読み書きする
  - 複数のExcelファイル間でデータをコピーする
  - フォント設定を変更する
  - Excelの行高や列幅を調整する
  - グラフを追加する

---

# OpenPyXLについて

- OpenPyXLはサードパーティライブラリなので環境によってはインストールが必要になります
- Google Colabの場合はすでにインストールされているのでインストール作業は不要です
- 念のためにインストールする場合はColabで以下のコードを入力して実行します


```python
!pip install openpyxl
```

---

# OpenPyXLについて

- OpenPyXLはライブラリなのでPython上で使うためにはインポートする必要があります
- インポートはNotebookのはじめに1回だけ実行すればそれ以降はインポートされた状態になります
- コーディングするうえで「`openpyxl`」を何度も書くのは面倒なので名前を「`op`」に変更してインポートします

```python
import openpyxl as op
```

---

# Excelの値を表示する

---

# Excelファイルの準備

- Moodleから「Shopping.xlsx」をダウンロードしてください
- MyDrive直下に作成した作業用フォルダにアップロードします
- アップロード方法
  - Colabからアップロードする方法
  - Driveからアップロードする方法


---

# 課題

---

# 課題

- Moodleにある「SCfCL-4th-prac.ipynb」ファイルをダウンロードしてColabにアップロードしてください
- 課題が完了したら「File」>「Download」>「Download .ipynb」で「.ipynb」形式でダウンロードしてください
- ダウンロードした **.ipynbファイル** をMoodleに提出してください
- 提出期限は **5月16日(木) 20時まで** です
