---
marp: true
math: katex
paginate: true
---
<!-- スライドURL：https://docs.google.com/presentation/d/1en3iGS3B-GlsSBFECzfODm5qjF3iIN72v04S5zuJzcw/edit?usp=sharing --->

# コンピュータリテラシ発展 〜Pythonを学ぶ〜

## 第8回：Excel作業の前工程・後工程の自動化」

情報学部 情報学科 情報メディア専攻
清水 哲也 ( shimizu@info.shonan-it.ac.jp )

---

# 今回の授業内容

---

# 今回の授業内容

- 前回の課題解説
- フォルダ・ファイル操作
- 課題

---

# 前回の課題解説

---

# 前回の課題解説

- 前回の課題の解答例を示します
- 解答例について質問があればご連絡ください

## 解答例

（あとでURLを貼り付ける）

---

# フォルダ・ファイル操作

---

# 絶対パスと相対パス

プログラムで外部ファイルを操作する際には，**場所に関する情報**を指定する必要があります

指定方法は2つあります
- **絶対パス**：絶対的な位置の記述（例：住所）
- **相対パス**：今自分がいる場所を起点にした位置の記述（例：道案内）

---

# 絶対パスと相対パス（絶対パスについて）

- OS(コンピュータ)で自分がいる場所に関する情報はツリー構造
- ツリー構造の基準
  - WindowsならCドライブ
  - LinuxやMacならルート（root）
- 基準から目的のファイルやフォルダまでのパスを記述するのが**絶対パス**

---

# 絶対パスと相対パス（絶対パスについて）

（絶対パスを解説する図を挿入）

---

# 絶対パスと相対パス（相対パスについて）

- 自分が現在操作しているフォルダをピリオド1つ「**.**」で表します
- 1つ上の階層のフォルダならピリオド２つ「**..**」で表します

---

# 絶対パスと相対パス（相対パスについて）

（絶対パスを解説する図を挿入）

---

# フォルダにあるファイルを一覧表示する

- 現在のフォルダの場所を確認します
- `os` モジュールをインポート
  - フォルダやファイルの操作などOSに依存しているさまざまな機能が備わっているモジュールです
- `getcwd()`関数
  - 現在自分がいるフォルダ（カレントディレクトリ）を絶対パスで表示
  - **get** **c**urrent **w**orking **d**irectoryの略

---

# フォルダにあるファイルを一覧表示する

- 現在のフォルダの場所を確認します
- Colabで実行するので「**￥**」ではなく「**/**」で表示されます

```py
import os

path = os.getcwd()
print(path)
```

---

# フォルダにあるファイルを一覧表示する

- 現在のフォルダにあるファイルの一覧を表示
- `listdir()`関数
  - 特定フォルダ内にあるファイルを一覧表示する関数
  - 引数はファイルを表示したいディレクトリ（フォルダ）のパス

---

# フォルダにあるファイルを一覧表示する

- 現在のフォルダにあるファイルの一覧を表示します
- 今自分がいるフォルダのファイルを一覧表示します

```py
import os # osモジュールは一度インポートしていれば再度書かかなくてもよい

path = os.getcwd()
files = os.listdir(path)

print(files)
```

---

# フォルダにあるファイルを一覧表示する

- 現在のフォルダにあるファイルの一覧を表示します
- Google Driveをマウントしてください
- 授業用フォルダ内のファイルを一覧表示します

```py
import os

# Google Driveをマウントして授業用フォルダのpathを書いてください
path = '/content/drive/MyDrive/???'
files = os.listdir(path)

print(files)
```

---

# フォルダにあるファイルを一覧表示する

- 相対パスを使ってファイルを一覧表示させます
- ColabはLinux系なので「**¥**」ではなく「**/**」を使います
- 一つ上のフォルダにあるファイルを一覧表示させます
  - パスには「`../`」を指定します

---

# フォルダにあるファイルを一覧表示する

- 相対パスを使ってファイルを一覧表示させます
- 一つ上のフォルダにあるファイルを一覧表示させます

```py
import os

path = '../'
files = os.listdir(path)

print(files)
```

---

# フォルダにあるファイルを一覧表示する

- 再帰的にフォルダの中身を表示します
- 出力結果の中にあるフォルダ（サブフォルダ）の中身を表示します
- `glob`モジュール
  - 再帰的なファイル検索を実行
  - 高度な検索が可能
- 再帰的とは
  - 自己の行為の結果が自己に戻ってくること

---

# フォルダにあるファイルを一覧表示する

- 再帰的にフォルダの中身を表示します
- 出力結果の中にあるフォルダ（サブフォルダ）の中身を表示します
- 表示を見やすくするためにpprintモジュールを利用します
- **注意**：MyDriveをよく使っている場合ファイル数が多く処理に時間がかかります

```py
import glob, pprint

files = glob.glob('/content/drive/MyDrive/**', recursive = True)

pprint.pprint(files)
```

---

# フォルダを作成する

- プログラムでフォルダを作成します
  - 特定の命名規則に従ってフォルダ生成
  - 大量のフォルダを生成
  - いろんな業務上で役に立つ

---

# フォルダを作成する

- フォルダを作成します
- `makedirs()`関数
  - 第1引数：作成するフォルダ名
  - 第2引数：「`exist_ok=True`」とすることですでに作成されていてもエラーが発生しない

### 実行例

```py
os.makedirs('file-name', exist_ok = True)
```

---

# フォルダを作成する

- フォルダを作成します
- `makedirs()`関数

```py
import os

os.makedirs('tmp', exist_ok = True)

print(os.listdir('.'))
```

---

# ファイルの書き込みと読み込み

- `open()`関数
  - Pythonに標準で用意されている関数
  - 引数
    - ファイル名
    - モードオプション
    - encodingオプション
    - newlineオプションなど

---

# ファイルの書き込みと読み込み

- `open()`関数
  - 引数
    - ファイル名
      - 作成するファイルの名前
      - ファイルの作成する場所をパスで指定
      - 例：`./file.txt`（カレントディレクトリに「file.txt」を作成）

---

# ファイルの書き込みと読み込み

- `open()`関数 - 引数 - モードオプション（一部）

| モード | 解説 |
|---|---|
| `r` | 読み込み用に開く（デフォルトのモード） |
| `w` | 書き込み用に開き，ファイルが存在する場合は内容を破棄して上書きする |
| `x` | 生成用に開き，ファイルが存在する場合は失敗する |
| `a` | 書き込み用に開き，ファイルが存在する場合は末尾に追記する |
| `b` | バイナリモードで開く（画像などのファイル読み込み時に使用）※1 |

※1：他のモードと組み合わせて，`rb`や`wb`のように使う

---

# ファイルの書き込みと読み込み

- `open()`関数
  - 引数
    - encodingオプション
      - テキストエンコーディングを指定
      - **UTF-8**, **Shift-JIS**など

---

# ファイルの書き込みと読み込み

- `open()`関数
  - 引数
    - newlineオプション
      - 改行コードの制御
      - 詳細は後ほど


---

# 課題

---

# 課題

- Moodleにある「SCfCL-7th-prac.ipynb」ファイルと「workinghours.xlsx」ファイルをダウンロードしてColabにアップロードしてください
- 課題が完了したら「File」>「Download」>「Download .ipynb」で「.ipynb」形式でダウンロードしてください
- ダウンロードした **.ipynbファイル** と作成した **Excelファイル3つ** をMoodleに提出してください
- 提出期限は **6月6日(木) 20時まで** です
